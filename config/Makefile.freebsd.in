#
# FreeBSD Makefile template
#
#
# $Id$
#
include ../Makefile.config
@AUTODEPRULE_SUBDIR@

CXXFLAGS += -I@top_srcdir@

OBJS = \
MeterMaker.o \
cpumeter.o \
memmeter.o \
netmeter.o \
loadmeter.o \
diskmeter.o \
pagemeter.o \
swapmeter.o \
swapinternal.o \
intmeter.o \
kernel.o

#  This next one is not yet supported in the FreeBSD port.
#serialmeter.o \

CFILES := $(OBJS:.o=.cc)
BSDCSRCS := MeterMaker.cc cpumeter.cc memmeter.cc netmeter.cc \
   loadmeter.cc diskmeter.cc pagemeter.cc kernel.cc swapmeter.cc \
   swapinternal.cc intmeter.cc

BSDHEADERS := $(BSDCSRCS:%.cc=%.h)
DEPFILES := $(OBJS:%=.%.d)

#-----------------------------------------------------------------------

all : makelinks libmeter.a # concatdepend

clean :
	rm -f $(OBJS) $(DEPFILES) libmeter.a *~

libmeter.a : $(OBJS)
	ar cvr libmeter.a $(OBJS)
	@RANLIB@ $@

makelinks:
	@echo "Checking that all common BSD source is up-to-date..."
	for f in $(BSDCSRCS) $(BSDHEADERS); do \
	  if [ ! -h $$f ]; then rm -f $$f && ln -s ../netbsd/$$f $$f; \
	fi; done

@AUTODEPEND@
